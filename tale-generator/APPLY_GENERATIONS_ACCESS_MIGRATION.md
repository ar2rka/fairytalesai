# Применение миграции для доступа к таблице generations

## Проблема

Если вы получаете ошибку 404 при попытке получить данные о генерациях через админские эндпоинты, это связано с политиками RLS (Row Level Security) на таблице `generations`.

## Решение

### Вариант 1: Использовать service_role ключ (Рекомендуется)

Service_role ключ автоматически обходит RLS, поэтому миграция не обязательна, но не повредит.

1. Откройте Supabase Dashboard → Settings → API
2. Найдите **service_role** key (НЕ anon key!)
3. Обновите переменную окружения `SUPABASE_KEY` в вашем `.env` файле:

```bash
SUPABASE_KEY=your_service_role_key_here
```

4. Перезапустите бекенд

### Вариант 2: Применить миграцию

Если вы хотите использовать anon ключ или уже используете service_role, но хотите явно настроить политики:

1. Откройте Supabase Dashboard → SQL Editor
2. Скопируйте содержимое файла `supabase/migrations/022_add_service_role_access_to_generations.sql`
3. Выполните SQL в редакторе
4. Или используйте скрипт для применения миграций:

```bash
python src/run_migrations.py
```

## Проверка

После применения миграции или переключения на service_role ключ:

1. Откройте `/admin/generations` в браузере
2. Должны отображаться все генерации из базы данных
3. Клик по ID генерации должен открывать детальную страницу

## Важно

- **service_role ключ** - секретный ключ, НЕ используйте его во фронтенде!
- **anon ключ** - публичный ключ, безопасен для использования во фронтенде
- Для бекенда рекомендуется использовать **service_role ключ**








